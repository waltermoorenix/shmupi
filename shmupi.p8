pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--shmup to learn lua d
function _init()
 cls(0)
 shipx=64 
 shipy=64 
 shipsx=0 
 shipsy=0 
 shipz=3
 bullets={}
 flamespr=5 
 muzzle=0
 bullet_active=false
 score=1000 
 lives=4
 starx={} 
 stary={}
 for i=1,100 do
  add(starx,flr(rnd(128)))
  add(stary,flr(rnd(128)))
 end
end
function _update()
 --controls
 shipsx=0 shipsy=0 shipz=3
 if btn(0) then shipsx=-2 shipz=2 end
 if btn(1) then shipsx=2 shipz=4 end
 if btn(2) then shipsy=-2 end
 if btn(3) then shipsy=2 end
 --shooting
 if btnp(5) then
 muzzle=5  
 bullet_active=true
 add(bullets,{
  x=shipx, y=shipy-3,
  spr=16, -- starting sprite
  timer=0, step=4, -- (cycles every 4 frames)
  sp={16,33,16,33} -- bullet sprite frames
 })
end 
   --animate muzzle
 if muzzle>0 then muzzle-=1 end
 --flame animation
 flamespr+=1 if flamespr>9 then flamespr=5 end
 --move bullet
for bullet in all(bullets) do
 bullet.y-=2 -- move up
 bullet.timer=(bullet.timer+1)%bullet.step
 if bullet.timer==0 then
  bullet.spr+=1
  if bullet.spr>#bullet.sp then bullet.spr=1 end
 end
 if bullet.y<-8 then del(bullets,bullet) end
end
 --move ship
 shipx+=shipsx 
 shipy+=shipsy
 --clamp ship
 if shipx>120 then shipx=0 end
 if shipx<0 then shipx=120 end
 if shipy>120 then shipy=120 end
 if shipy<0 then shipy=0 end
end
function _draw()
 cls(0)
 --map
  map(0, 0, 0, 0, 16, 16)
 --draw lives
 for i=1,4 do
  if lives>i then spr(18,i*9-8,1) end
 end
 starfield()
 print("score:"..score,40,2,12)
 spr(flamespr,shipx,shipy+7)
 if muzzle>0 then circfill(shipx+4,shipy-2,muzzle,7) end
 spr(shipz,shipx,shipy)
for bullet in all(bullets) do
 spr(bullet.sp[bullet.spr],bullet.x,bullet.y)
end
end
-->8
function starfield()
 for i=1,#starx do
  pset(starx[i],stary[i],7)
  stary[i]+=1
  if stary[i]>127 then stary[i]=0 end
 end
end
__gfx__
00000000000000000000200000022000000200000000000000000000077cc7700000000000000000000000000000000000000000000000000000000000000000
000000000000000000002000002ee200000200000007700000777700000000000077770000077000000000000000000000000000000055555555000000000000
0000000000000000000c8000028cc8200008c00000c77c00000cc00000000000000cc00000c77c000000000000000000000000000555dddddddd555000000000
0000000000000000000ee000228ee822000ee00000cccc0000000000000000000000000000cccc000000000000000000000000055dddd6ddddddddd550000000
0000000000000000002220002222222200022200000cc000000000000000000000000000000cc00000000000000000000000005dddddddddddddddddd5000000
000000000000000000028000288668820008200000000000000000000000000000000000000000000000000000000000000055dddddddddddddd6ddddd550000
000000000000000000008000882dd288000800000000000000000000000000000000000000000000000000000000000000005dddd6ddddddddddddddddd50000
0000000000000000000770000007700000077000000000000000000000000000000000000000000000000000000000000005dddddddddd55dddddddddddd5000
00000000000000000880088008800880000000000000000000000000000000000000000000000000dd6666dddd5555dd005ddddddddd5555ddd6dddd6dddd500
00099000000000008888888880888808000000000000000000000000000000000000000000000000d655556dd5dddd5d05ddd55ddddd6555dddddddddddddd50
009aa900000aa00088888888800000080000000000000000000000000000000000000000000000006555555d5dddddd605ddd55ddddd5555ddd55ddddd6ddd50
09a77a9000a77a0088888888800000080000000000000000000000000000000000000000000000006555555d5dddddd605dddddd6dddd55dd6d56ddddddddd50
09a77a9000a77a0008888880080000800000000000000000000000000000000000000000000000006555555d5dddddd65dddddddddddddddddddddddddddddd5
009aa900000aa00000888800008008000000000000000000000000000000000000000000000000006555555d5dddddd65dddddddddd6dddddddddddddd5dddd5
00099000000000000008800000088000000000000000000000000000000000000000000000000000d65555ddd6dddd6d5dd6dd55dddddddddddddddd555dddd5
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddddd6666dd5ddddd55dddddddd6dd6dddd555dddd5
00000000000000000000000000000000000000000000000000000000000000000000000000000000dd5555dddd6666dd5ddddd555dddd555ddddddd555dd6dd5
00011000000770000000000000000000000000000000000000000000000000000000000000000000d6dddd5dd6dddd6d5ddd6d555ddd5555dddd6dddddddddd5
001cc100007aa70000000000000000000000000000000000000000000000000000000000000000006dddddd56dddddd65dddd555dddd5555ddddddddddddddd5
01c77c1000a99a0000000000000000000000000000000000000000000000000000000000000000006dddddd56dddddd65dddd55dddd5555ddddddd6d6dddddd5
01c77c1000a99a0000000000000000000000000000000000000000000000000000000000000000006dddddd56dddddd605ddddddddd555ddddd6ddddddd6dd50
001cc100007aa70000000000000000000000000000000000000000000000000000000000000000006dddddd56dddddd605dddddd6ddddddddddddddddddddd50
00011000000770000000000000000000000000000000000000000000000000000000000000000000d6dddd5dd6dddd6d05dddddd6dd66dddddddddd555dddd50
00000000000000000000000000000000000000000000000000000000000000000000000000000000dd5555dddd6666dd005dddddddd666dddddddd6555ddd500
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd555555550005dddddddddddd5ddddddddddd5000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd5555555500005dddd555ddd55d6d66ddddd50000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd55555555000055ddd555dd555ddd66dddd550000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd555555550000005dddddddddddddddddd5000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd55555555000000055dddddddddddddd550000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd55555555000000000555d5555555555000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd5555555500000000000055555555000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000dddddddd5555555500000000000000000000000000000000
__map__
000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000c0d0e0f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001c1e3a1f00000a0a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000002c1b1e2f0000010a0a0a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000003c3d3e3f00000a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000010000000000000a0a0a0a0a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000a000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100002e5502b550295502655023550205501c5501755013550105500d5500a5500755003550005500000000000000000000000000000000000000000000000000000000000000000000000000000000000000
